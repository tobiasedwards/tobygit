{"type":"blob","contents":"#! /usr/bin/env node\n\nvar dir = require('../src/dir')\nvar index = require('../src/index');\nvar fs = require('fs');\nvar path = require('path');\nvar sha1 = require('sha1');\n\nif (dir.tobygitDirPath() !== null) {\n  index.indexTree(dir.projectRootPath(), function(err, tree) {\n    index.processObject('root', tree, function(err, processed) {\n      var head = {\n        type: 'ref',\n        tree: processed.hash\n      };\n\n      var headPath = path.join(dir.tobygitDirPath(), 'head');\n\n      fs.open(headPath, 'w', function(err, fd) {\n        fs.write(fd, JSON.stringify(head), function(err, written, string) {\n          console.log('indexing complete');\n        });\n      });\n    });\n  });\n} else {\n  console.log('tobygit has not been initialised\\ntry running tgit-init');\n}\n"}